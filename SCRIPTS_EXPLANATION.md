# üìú –û–±—ä—è—Å–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ –ø—Ä–æ–µ–∫—Ç–µ

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [Batch-—Å–∫—Ä–∏–ø—Ç—ã (Windows)](#batch-—Å–∫—Ä–∏–ø—Ç—ã-windows)
2. [Jenkinsfile (Groovy Pipeline)](#jenkinsfile-groovy-pipeline)
3. [Dockerfile –∫–æ–º–∞–Ω–¥—ã](#dockerfile-–∫–æ–º–∞–Ω–¥—ã)
4. [–û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤](#–æ–±—â–∏–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã-—Ä–∞–±–æ—Ç—ã-—Å–∫—Ä–∏–ø—Ç–æ–≤)

---

## ü™ü Batch-—Å–∫—Ä–∏–ø—Ç—ã (Windows)

### –ß—Ç–æ —Ç–∞–∫–æ–µ .bat —Ñ–∞–π–ª—ã?
**Batch-—Å–∫—Ä–∏–ø—Ç—ã** ‚Äî —ç—Ç–æ —Ñ–∞–π–ª—ã —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.bat` –∏–ª–∏ `.cmd`, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥ –¥–ª—è Windows Command Prompt. –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å—Ç—Ä–æ—á–Ω–æ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–∞–Ω–¥:

```batch
@echo off          # –û—Ç–∫–ª—é—á–∞–µ—Ç –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
echo —Ç–µ–∫—Å—Ç         # –í—ã–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –Ω–∞ —ç–∫—Ä–∞–Ω
cd –ø–∞–ø–∫–∞           # –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –ø–∞–ø–∫—É
call –∫–æ–º–∞–Ω–¥–∞       # –í—ã–∑—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É (–≤–∞–∂–Ω–æ –¥–ª—è .bat —Ñ–∞–π–ª–æ–≤)
if —É—Å–ª–æ–≤–∏–µ         # –£—Å–ª–æ–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
exit /b –∫–æ–¥        # –í—ã—Ö–æ–¥ —Å –∫–æ–¥–æ–º –æ—à–∏–±–∫–∏
```

---

## üìÑ build.bat ‚Äî –°–±–æ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Å–±–æ—Ä–∫—É –≤—Å–µ—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```batch
@echo off
echo ============================================
echo Building Microservices Project
echo ============================================
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `@echo off` ‚Äî —Å–∫—Ä—ã–≤–∞–µ—Ç –≤—ã–≤–æ–¥ —Å–∞–º–∏—Ö –∫–æ–º–∞–Ω–¥, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- `echo` ‚Äî –≤—ã–≤–æ–¥–∏—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏

```batch
echo.
echo [1/5] Building events-contract...
cd events-contract
call mvnw.cmd clean install -DskipTests
if %ERRORLEVEL% NEQ 0 (
    echo ERROR: Failed to build events-contract
    exit /b 1
)
cd ..
```

**–ü–æ—à–∞–≥–æ–≤–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ:**

1. **`echo.`** ‚Äî –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
2. **`echo [1/5] Building events-contract...`** ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. **`cd events-contract`** ‚Äî –ø–µ—Ä–µ—Ö–æ–¥ –≤ –ø–∞–ø–∫—É `events-contract`
4. **`call mvnw.cmd clean install -DskipTests`** ‚Äî –≤—ã–∑–æ–≤ Maven Wrapper:
   - `clean` ‚Äî –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å–±–æ—Ä–∫–∏
   - `install` ‚Äî —Å–±–æ—Ä–∫–∞ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Maven —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
   - `-DskipTests` ‚Äî –ø—Ä–æ–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ (–¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è)
5. **`if %ERRORLEVEL% NEQ 0`** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞:
   - `%ERRORLEVEL%` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å –∫–æ–¥–æ–º –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã
   - `NEQ 0` ‚Äî "Not Equal 0" (–æ—à–∏–±–∫–∞)
   - –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –≤—ã—Ö–æ–¥–∏—Ç
6. **`cd ..`** ‚Äî –≤–æ–∑–≤—Ä–∞—Ç –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞

### –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```
1. events-contract      ‚Üí –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ Maven (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –¥—Ä—É–≥–∏—Ö)
2. books-api-contract   ‚Üí –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ Maven (–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–ª—è –¥—Ä—É–≥–∏—Ö)
3. demo-rest            ‚Üí –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ JAR (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤)
4. analytics-service    ‚Üí –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ JAR
5. audit-service        ‚Üí –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ JAR
6. ws (notification)   ‚Üí –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ JAR
7. Docker images        ‚Üí –°–æ–±–∏—Ä–∞—é—Ç—Å—è –æ–±—Ä–∞–∑—ã –∏–∑ Dockerfile
```

### –ü–æ—á–µ–º—É —Ç–∞–∫–æ–π –ø–æ—Ä—è–¥–æ–∫?
- **–ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã** (events-contract, books-api-contract) –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–±—Ä–∞–Ω—ã –ø–µ—Ä–≤—ã–º–∏
- –û–Ω–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Maven —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (`~/.m2/repository`)
- –î—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏—Ö –∫–∞–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ï—Å–ª–∏ —Å–æ–±—Ä–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ ‚Üí –æ—à–∏–±–∫–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `%ERRORLEVEL%`:

```batch
if %ERRORLEVEL% NEQ 0
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `ERRORLEVEL` ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è Windows
- –°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã
- `0` = —É—Å–ø–µ—Ö, –ª—é–±–æ–µ –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ = –æ—à–∏–±–∫–∞
- `NEQ 0` = "–Ω–µ —Ä–∞–≤–Ω–æ –Ω—É–ª—é" (–æ—à–∏–±–∫–∞)

**–ü—Ä–∏–º–µ—Ä:**
```batch
mvnw.cmd clean install
# –ï—Å–ª–∏ —É—Å–ø–µ—Ö ‚Üí ERRORLEVEL = 0
# –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí ERRORLEVEL = 1 (–∏–ª–∏ –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ)

if %ERRORLEVEL% NEQ 0 (
    echo –û—à–∏–±–∫–∞!
    exit /b 1
)
```

---

## üöÄ start.bat ‚Äî –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–ó–∞–ø—É—Å–∫–∞–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —á–µ—Ä–µ–∑ Docker Compose.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```batch
@echo off
echo ============================================
echo Starting Microservices with Docker Compose
echo ============================================
```

**–®–∞–≥ 1: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤**
```batch
echo.
echo Stopping existing containers...
docker-compose down --remove-orphans
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `docker-compose down` ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- `--remove-orphans` ‚Äî —É–¥–∞–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –Ω–µ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –≤ compose
- –ù—É–∂–Ω–æ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–æ—Ä—Ç–æ–≤

**–®–∞–≥ 2: –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤**
```batch
echo.
echo Starting all services...
docker-compose up -d
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `docker-compose up` ‚Äî —Å–æ–∑–¥–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- `-d` ‚Äî detached mode (–≤ —Ñ–æ–Ω–µ, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª)

**–®–∞–≥ 3: –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞**
```batch
echo.
echo Waiting for services to start...
timeout /t 30 /nobreak
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `timeout /t 30` ‚Äî –∂–¥–µ—Ç 30 —Å–µ–∫—É–Ω–¥
- `/nobreak` ‚Äî –Ω–µ–ª—å–∑—è –ø—Ä–µ—Ä–≤–∞—Ç—å –Ω–∞–∂–∞—Ç–∏–µ–º –∫–ª–∞–≤–∏—à–∏
- –ù—É–∂–Ω–æ, —á—Ç–æ–±—ã —Å–µ—Ä–≤–∏—Å—ã —É—Å–ø–µ–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è

**–®–∞–≥ 4: –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**
```batch
echo.
echo ============================================
echo All services started!
echo ============================================
echo.
echo Access points:
echo   - Demo REST API:     http://localhost:8080
...
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –í—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ URL –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º
- –ü–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞–π—Ç–∏ –Ω—É–∂–Ω—ã–π —Å–µ—Ä–≤–∏—Å

---

## üõë stop.bat ‚Äî –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```batch
@echo off
echo ============================================
echo Stopping Microservices
echo ============================================

docker-compose down --remove-orphans

echo.
echo All services stopped.
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `docker-compose down` ‚Äî –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- `--remove-orphans` ‚Äî —É–¥–∞–ª—è–µ—Ç "—Å–∏—Ä–æ—Ç—Å–∫–∏–µ" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫ –æ—à–∏–±–æ–∫ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏)

---

## üì¶ prepare-libs.bat ‚Äî –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:
–°–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏), –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω—ã –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```batch
@echo off
echo ============================================
echo Preparing Local Libraries for Docker Build
echo ============================================

echo.
echo [1/2] Building and installing events-contract...
cd events-contract
call mvnw.cmd clean install -DskipTests
if %ERRORLEVEL% NEQ 0 (
    echo ERROR: Failed to build events-contract
    exit /b 1
)
cd ..

echo.
echo [2/2] Building and installing books-api-contract...
cd books-api-contract
call mvnw.cmd clean install -DskipTests
if %ERRORLEVEL% NEQ 0 (
    echo ERROR: Failed to build books-api-contract
    exit /b 1
)
cd ..
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –°–æ–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã (–±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏—Ö –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Maven —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π Docker-–æ–±—Ä–∞–∑–æ–≤
- Dockerfile –∫–æ–ø–∏—Ä—É–µ—Ç JAR –∏–∑ `target/`, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ

---

## üîß Jenkinsfile (Groovy Pipeline)

### –ß—Ç–æ —Ç–∞–∫–æ–µ Jenkinsfile?
**Jenkinsfile** ‚Äî —ç—Ç–æ —Ñ–∞–π–ª –Ω–∞ —è–∑—ã–∫–µ Groovy, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç pipeline (–∫–æ–Ω–≤–µ–π–µ—Ä) –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤ Jenkins.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Pipeline:

```groovy
pipeline {
    agent any
    stages {
        stage('–ù–∞–∑–≤–∞–Ω–∏–µ') {
            steps {
                // –ö–æ–º–∞–Ω–¥—ã
            }
        }
    }
}
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –±–ª–æ–∫–∏:

#### 1. `pipeline { }` ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π –±–ª–æ–∫
```groovy
pipeline {
    agent any
    environment {
        VAR = "value"
    }
    options {
        timeout(time: 30, unit: 'MINUTES')
    }
    stages { }
    post { }
}
```

#### 2. `agent any` ‚Äî –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å
- `any` ‚Äî –Ω–∞ –ª—é–±–æ–º –¥–æ—Å—Ç—É–ø–Ω–æ–º –∞–≥–µ–Ω—Ç–µ Jenkins
- `none` ‚Äî –±–µ–∑ –∞–≥–µ–Ω—Ç–∞
- `docker { image '...' }` ‚Äî –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

#### 3. `stages { }` ‚Äî —ç—Ç–∞–ø—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```groovy
stages {
    stage('Build') {
        steps {
            sh './mvnw clean package'
        }
    }
}
```

#### 4. `steps { }` ‚Äî –∫–æ–º–∞–Ω–¥—ã –≤ —ç—Ç–∞–ø–µ
```groovy
steps {
    sh '–∫–æ–º–∞–Ω–¥–∞'           # –í—ã–ø–æ–ª–Ω–∏—Ç—å shell-–∫–æ–º–∞–Ω–¥—É
    echo '—Ç–µ–∫—Å—Ç'           # –í—ã–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç
    dir('–ø–∞–ø–∫–∞') { }       # –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤ –ø–∞–ø–∫–µ
    script { }             # Groovy-–∫–æ–¥
}
```

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –≤–∞—à–µ–≥–æ Jenkinsfile:

#### –ü—Ä–∏–º–µ—Ä 1: –ü—Ä–æ—Å—Ç–æ–π —ç—Ç–∞–ø
```groovy
stage('Checkout') {
    steps {
        echo '–ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞...'
        checkout scm
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `stage('Checkout')` ‚Äî —ç—Ç–∞–ø —Å –∏–º–µ–Ω–µ–º "Checkout"
- `echo` ‚Äî –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–≥
- `checkout scm` ‚Äî –∫–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ Git

#### –ü—Ä–∏–º–µ—Ä 2: –≠—Ç–∞–ø —Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π
```groovy
stage('Build Contracts') {
    steps {
        dir('events-contract') {
            sh 'chmod +x ./mvnw && ./mvnw clean install -DskipTests'
        }
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `dir('events-contract')` ‚Äî –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –ø–∞–ø–∫—É
- `sh '...'` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç shell-–∫–æ–º–∞–Ω–¥—É
- `chmod +x ./mvnw` ‚Äî –¥–∞–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- `&&` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–µ—Ä–≤–∞—è —É—Å–ø–µ—à–Ω–∞

#### –ü—Ä–∏–º–µ—Ä 3: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```groovy
stage('Build Services') {
    parallel {
        stage('Build Demo REST') {
            steps {
                dir('demo-rest') {
                    sh './mvnw clean package'
                }
            }
        }
        stage('Build Analytics Service') {
            steps {
                dir('analytics-service') {
                    sh './mvnw clean package'
                }
            }
        }
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `parallel { }` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç —ç—Ç–∞–ø—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –£—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –í—Å–µ —ç—Ç–∞–ø—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

#### –ü—Ä–∏–º–µ—Ä 4: –£—Å–ª–æ–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```groovy
script {
    if (!command -v docker-compose &> /dev/null; then
        echo "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ docker-compose..."
        curl -SL ... -o /tmp/docker-compose
        chmod +x /tmp/docker-compose
    fi
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `script { }` ‚Äî –±–ª–æ–∫ Groovy-–∫–æ–¥–∞
- `if !command -v ...` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–æ–º–∞–Ω–¥—ã
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç docker-compose, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç

#### –ü—Ä–∏–º–µ—Ä 5: Retry (–ø–æ–≤—Ç–æ—Ä –ø—Ä–∏ –æ—à–∏–±–∫–µ)
```groovy
retry(3) {
    dir('events-contract') {
        sh './mvnw clean install -DskipTests'
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `retry(3)` ‚Äî –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –¥–æ 3 —Ä–∞–∑ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)

#### –ü—Ä–∏–º–µ—Ä 6: Post-–¥–µ–π—Å—Ç–≤–∏—è
```groovy
post {
    always {
        echo 'Pipeline –∑–∞–≤–µ—Ä—à–µ–Ω'
        deleteDir()
    }
    success {
        echo '–°–±–æ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!'
    }
    failure {
        echo '–°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π!'
    }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `post { }` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
- `always` ‚Äî –≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- `success` ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
- `failure` ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–µ
- `deleteDir()` ‚Äî –æ—á–∏—â–∞–µ—Ç workspace

---

## üê≥ Dockerfile –∫–æ–º–∞–Ω–¥—ã

### –ß—Ç–æ —Ç–∞–∫–æ–µ Dockerfile?
**Dockerfile** ‚Äî –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Docker-–æ–±—Ä–∞–∑–∞. –ö–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π –æ–±—Ä–∞–∑–∞.

### –ö–æ–º–∞–Ω–¥—ã –≤ –≤–∞—à–µ–º Dockerfile:

#### 1. `FROM` ‚Äî –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
```dockerfile
FROM eclipse-temurin:21-jre-alpine
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –ë–µ—Ä–µ—Ç –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å Java 21 JRE
- `alpine` ‚Äî –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –≤–µ—Ä—Å–∏—è Linux
- –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è –≤–∞—à–µ–≥–æ –æ–±—Ä–∞–∑–∞

#### 2. `WORKDIR` ‚Äî —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
```dockerfile
WORKDIR /app
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–µ—Ç –ø–∞–ø–∫—É `/app` (–µ—Å–ª–∏ –Ω–µ—Ç)
- –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ –Ω–µ–π
- –≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç `cd /app`

#### 3. `RUN` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
```dockerfile
RUN addgroup -S javauser && adduser -S javauser -G javauser
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–ø—Ä–∏ —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞**
- `addgroup -S javauser` ‚Äî —Å–æ–∑–¥–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—É—é –≥—Ä—É–ø–ø—É
- `adduser -S javauser -G javauser` ‚Äî —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `&&` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Ç–æ—Ä—É—é –∫–æ–º–∞–Ω–¥—É —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–µ—Ä–≤–∞—è —É—Å–ø–µ—à–Ω–∞

#### 4. `COPY` ‚Äî –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
```dockerfile
ARG JAR_FILE=target/*.jar
COPY ${JAR_FILE} app.jar
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `ARG` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤—Ä–µ–º–µ–Ω–∏ —Å–±–æ—Ä–∫–∏
- `COPY` ‚Äî –∫–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –∏–∑ —Ö–æ—Å—Ç–∞ –≤ –æ–±—Ä–∞–∑
- `${JAR_FILE}` ‚Äî –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
- –ö–æ–ø–∏—Ä—É–µ—Ç JAR –≤ –æ–±—Ä–∞–∑ –∫–∞–∫ `app.jar`

#### 5. `USER` ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```dockerfile
USER javauser
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –ü–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ—Ç –µ–≥–æ –∏–º–µ–Ω–∏
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ–º –æ—Ç root

#### 6. `EXPOSE` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–∞
```dockerfile
EXPOSE 8080
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- **–ù–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Ä—Ç**, —Ç–æ–ª—å–∫–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–µ—Ç
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–µ–ª–∞–µ—Ç—Å—è –≤ `docker-compose.yml`

#### 7. `ENV` ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```dockerfile
ENV JAVA_OPTS="-XX:+UseContainerSupport -XX:MaxRAMPercentage=75.0"
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `JAVA_OPTS` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã JVM
- `UseContainerSupport` ‚Äî —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- `MaxRAMPercentage=75.0` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞–∫—Å–∏–º—É–º 75% –ø–∞–º—è—Ç–∏

#### 8. `HEALTHCHECK` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è
```dockerfile
HEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \
    CMD wget -q --spider http://localhost:8080/actuator/health || exit 1
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- `--interval=30s` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
- `--timeout=3s` ‚Äî —Ç–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞ 3 —Å–µ–∫—É–Ω–¥—ã
- `--start-period=60s` ‚Äî –ø–µ—Ä–≤—ã–µ 60 —Å–µ–∫—É–Ω–¥ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º (–∑–∞–ø—É—Å–∫)
- `--retries=3` ‚Äî 3 –ø–æ–ø—ã—Ç–∫–∏ –ø–µ—Ä–µ–¥ –ø–æ–º–µ—Ç–∫–æ–π –∫–∞–∫ unhealthy
- `CMD` ‚Äî –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ (HTTP-–∑–∞–ø—Ä–æ—Å –∫ health endpoint)

#### 9. `ENTRYPOINT` ‚Äî –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞
```dockerfile
ENTRYPOINT ["sh", "-c", "java $JAVA_OPTS -jar app.jar"]
```
**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞**
- `["sh", "-c", "..."]` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç shell –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∫–æ–º–∞–Ω–¥—É
- `$JAVA_OPTS` ‚Äî –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ó–∞–ø—É—Å–∫–∞–µ—Ç Java-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## üîÑ –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å–∫—Ä–∏–ø—Ç–æ–≤

### 1. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
–°–∫—Ä–∏–ø—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **—Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑**, —Å—Ç—Ä–æ–∫–∞ –∑–∞ —Å—Ç—Ä–æ–∫–æ–π:

```batch
echo –®–∞–≥ 1
cd –ø–∞–ø–∫–∞
echo –®–∞–≥ 2
call –∫–æ–º–∞–Ω–¥–∞
echo –®–∞–≥ 3
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
```batch
call –∫–æ–º–∞–Ω–¥–∞
if %ERRORLEVEL% NEQ 0 (
    echo –û—à–∏–±–∫–∞!
    exit /b 1
)
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–æ–º–∞–Ω–¥—ã
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏—Ö –∫–æ–º–∞–Ω–¥ –ø—Ä–∏ –æ—à–∏–±–∫–µ

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```batch
set VAR=–∑–Ω–∞—á–µ–Ω–∏–µ
echo %VAR%
```

**–í Jenkinsfile:**
```groovy
environment {
    VAR = "–∑–Ω–∞—á–µ–Ω–∏–µ"
}
sh 'echo $VAR'
```

### 4. –£—Å–ª–æ–≤–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```batch
if —É—Å–ª–æ–≤–∏–µ (
    –∫–æ–º–∞–Ω–¥–∞1
) else (
    –∫–æ–º–∞–Ω–¥–∞2
)
```

**–í Jenkinsfile:**
```groovy
script {
    if (—É—Å–ª–æ–≤–∏–µ) {
        sh '–∫–æ–º–∞–Ω–¥–∞1'
    } else {
        sh '–∫–æ–º–∞–Ω–¥–∞2'
    }
}
```

### 5. –¶–∏–∫–ª—ã
```batch
for %%i in (1 2 3) do (
    echo %%i
)
```

**–í Jenkinsfile:**
```groovy
script {
    for (int i = 1; i <= 3; i++) {
        echo "${i}"
    }
}
```

### 6. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
**–í Jenkinsfile:**
```groovy
parallel {
    stage('A') { steps { sh '–∫–æ–º–∞–Ω–¥–∞1' } }
    stage('B') { steps { sh '–∫–æ–º–∞–Ω–¥–∞2' } }
}
```

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- –û–±–∞ —ç—Ç–∞–ø–∞ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –£—Å–∫–æ—Ä—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–≤

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Batch (.bat) | Jenkinsfile (Groovy) | Dockerfile |
|----------------|--------------|----------------------|------------|
| **–ì–¥–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è** | Windows CMD | Jenkins –∞–≥–µ–Ω—Ç | Docker build |
| **–ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è** | –í—Ä—É—á–Ω—É—é | –ü—Ä–∏ –∫–æ–º–º–∏—Ç–µ/–∑–∞–ø—É—Å–∫–µ | –ü—Ä–∏ —Å–±–æ—Ä–∫–µ –æ–±—Ä–∞–∑–∞ |
| **–Ø–∑—ã–∫** | Batch | Groovy | Docker DSL |
| **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º** | –ù–µ—Ç | –î–∞ (parallel) | –ù–µ—Ç |
| **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** | `if %ERRORLEVEL%` | `catchError`, `retry` | `RUN` —Å `||` |
| **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ** | `%VAR%` | `$VAR` –∏–ª–∏ `${VAR}` | `$VAR` –∏–ª–∏ `${VAR}` |

---

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –°–±–æ—Ä–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
```batch
echo Building service...
cd service
call mvnw.cmd clean package
if %ERRORLEVEL% NEQ 0 (
    echo ERROR: Build failed
    exit /b 1
)
echo Build successful!
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –í—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ –ø–∞–ø–∫—É
3. –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç
4. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ø–µ—à–Ω–æ—Å—Ç—å
5. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí –≤—ã—Ö–æ–¥–∏—Ç
6. –ï—Å–ª–∏ —É—Å–ø–µ—Ö ‚Üí –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç

### –ü—Ä–∏–º–µ—Ä 2: –£—Å–ª–æ–≤–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
```groovy
script {
    sh '''
        if ! command -v docker-compose &> /dev/null; then
            echo "Installing docker-compose..."
            curl -SL ... -o /tmp/docker-compose
            chmod +x /tmp/docker-compose
        else
            echo "docker-compose already installed"
        fi
    '''
}
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–æ–º–∞–Ω–¥—ã `docker-compose`
2. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–∫–∞—á–∏–≤–∞–µ—Ç –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç
3. –ï—Å–ª–∏ –µ—Å—Ç—å ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫—É

### –ü—Ä–∏–º–µ—Ä 3: –ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```batch
cd service1
call mvnw.cmd clean install
if %ERRORLEVEL% NEQ 0 exit /b 1
cd ..

cd service2
call mvnw.cmd clean install
if %ERRORLEVEL% NEQ 0 exit /b 1
cd ..
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
- –ï—Å–ª–∏ service1 –Ω–µ —Å–æ–±—Ä–∞–ª—Å—è ‚Üí —Å–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- service2 –Ω–µ –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å—Å—è (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç service1)

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

**–í1: –ü–æ—á–µ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `call` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞?**
**–û1:** –í batch-—Å–∫—Ä–∏–ø—Ç–∞—Ö `call` –Ω—É–∂–µ–Ω –¥–ª—è –≤—ã–∑–æ–≤–∞ –¥—Ä—É–≥–∏—Ö .bat —Ñ–∞–π–ª–æ–≤. –ë–µ–∑ `call` —Å–∫—Ä–∏–ø—Ç –º–æ–∂–µ—Ç –Ω–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞.

**–í2: –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç `-DskipTests`?**
**–û2:** –ü–∞—Ä–∞–º–µ—Ç—Ä Maven, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤. –£—Å–∫–æ—Ä—è–µ—Ç —Å–±–æ—Ä–∫—É, –Ω–æ —Ç–µ—Å—Ç—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è.

**–í3: –ó–∞—á–µ–º –Ω—É–∂–µ–Ω `cd ..` –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞?**
**–û3:** –ß—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –≤ —Å–ª–µ–¥—É—é—â—É—é –ø–∞–ø–∫—É. –ò–Ω–∞—á–µ —Å–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—É—Ç–∏.

**–í4: –ß—Ç–æ —Ç–∞–∫–æ–µ `%ERRORLEVEL%`?**
**–û4:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è Windows, –∫–æ—Ç–æ—Ä–∞—è —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –≤–æ–∑–≤—Ä–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∫–æ–º–∞–Ω–¥—ã. `0` = —É—Å–ø–µ—Ö, –¥—Ä—É–≥–æ–µ —á–∏—Å–ª–æ = –æ—à–∏–±–∫–∞.

**–í5: –í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `sh` –∏ `bat` –≤ Jenkinsfile?**
**–û5:** 
- `sh` ‚Äî –¥–ª—è Linux/Unix –∫–æ–º–∞–Ω–¥
- `bat` ‚Äî –¥–ª—è Windows –∫–æ–º–∞–Ω–¥
- –í –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `sh`, –ø–æ—Ç–æ–º—É —á—Ç–æ Jenkins —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Linux-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ

**–í6: –ü–æ—á–µ–º—É –≤ Dockerfile –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `USER javauser`?**
**–û6:** –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –æ—Ç root. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω, —É—â–µ—Ä–± –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –ø—Ä–∞–≤–∞–º–∏ –Ω–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–í7: –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç `-d` –≤ `docker-compose up -d`?**
**–û7:** `-d` = detached mode (—Ñ–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º). –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ —Ñ–æ–Ω–µ, —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.

**–í8: –ó–∞—á–µ–º –Ω—É–∂–µ–Ω `timeout /t 30` –≤ start.bat?**
**–û8:** –î–∞–µ—Ç –≤—Ä–µ–º—è —Å–µ—Ä–≤–∏—Å–∞–º –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è. –ë–µ–∑ —ç—Ç–æ–≥–æ —Å–∫—Ä–∏–ø—Ç —Å—Ä–∞–∑—É –≤—ã–≤–µ–¥–µ—Ç "–≥–æ—Ç–æ–≤–æ", –Ω–æ —Å–µ—Ä–≤–∏—Å—ã –µ—â–µ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –≥–æ—Ç–æ–≤—ã.

---

## üéì –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ö–µ–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### build.bat:
```
1. –°–±–æ—Ä–∫–∞ events-contract ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ Maven
2. –°–±–æ—Ä–∫–∞ books-api-contract ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ Maven
3. –°–±–æ—Ä–∫–∞ demo-rest ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ JAR
4. –°–±–æ—Ä–∫–∞ analytics-service ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ JAR
5. –°–±–æ—Ä–∫–∞ audit-service ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ JAR
6. –°–±–æ—Ä–∫–∞ ws ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ JAR
7. –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–æ–≤
```

### start.bat:
```
1. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ docker-compose
3. –û–∂–∏–¥–∞–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥
4. –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –¥–æ—Å—Ç—É–ø–µ
```

### Jenkinsfile:
```
1. Checkout (–∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)
2. Build Contracts (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)
3. Build Services (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
4. Run Tests (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)
5. Build Docker Images
6. Deploy to Docker
7. Health Check
8. Post-–¥–µ–π—Å—Ç–≤–∏—è (–æ—á–∏—Å—Ç–∫–∞, —Å–æ–æ–±—â–µ–Ω–∏—è)
```

---

**–¢–µ–ø–µ—Ä—å –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—é—Ç –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ! üéâ**

